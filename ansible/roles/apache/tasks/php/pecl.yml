---
- name: Ensure pecl is installed (if configured).
  package:
    name: "{{ php_pecl_package }}"
    state: present
  when: php_pecl_install_pecl
  become: yes

 # xdebug requires PHP (version >= 7.2.0, version <= 8.0.99)
- name: Install PECL libaries supported also by PHP 8
  shell: "yes '' | {{ php_pecl_install_command }} {{ item }}"
  register: pecl_result
  changed_when: pecl_result is succeeded
  failed_when: "not (('already installed' in pecl_result.stdout) or ('install ok:' in pecl_result.stdout))"
  with_items:
    - xdebug
  become: yes
  when: params['php_version'] != 5.6
